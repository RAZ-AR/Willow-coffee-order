# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://willow-coffee-order.onrender.com/api/test-notifications/env
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```json
{
  "ok": true,
  "environment": {
    "hasTelegramToken": true,
    "telegramTokenLength": 46,
    "hasGroupChatId": true,
    "groupChatId": "-1002479746516",
    "hasSupabaseUrl": true,
    "hasSupabaseKey": true,
    "nodeEnv": "production"
  }
}
```

**–í–∞–∂–Ω–æ:**
- `hasTelegramToken` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `true`
- `hasGroupChatId` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `true`
- `groupChatId` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `-1002479746516` (—Å –º–∏–Ω—É—Å–æ–º!)

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ `false` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ Render.

## –®–∞–≥ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –≥—Ä—É–ø–ø—É

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://willow-coffee-order.onrender.com/api/test-notifications/group
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "ok": true,
  "test": "group_message",
  "groupId": "-1002479746516",
  "result": {
    "ok": true,
    "result": { ... }
  }
}
```

**–¢–∞–∫–∂–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É Telegram:**
```
üß™ Test Group Message

–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É –ø–µ—Ä—Å–æ–Ω–∞–ª–∞.
–ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ!
```

### –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ù–ï –ø—Ä–∏—à–ª–æ:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≥—Ä—É–ø–ø—É –≤ Telegram
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ - —Ç–∞–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å @Willow_coffee_bot

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞**
   - –ì—Ä—É–ø–ø–∞ ‚Üí Manage Group ‚Üí Administrators
   - –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
   - –£ –±–æ—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∞–≤–∞ "Send messages"

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ GROUP_CHAT_ID**
   - ID –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –º–∏–Ω—É—Å–∞: `-1002479746516`
   - –ï—Å–ª–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ—Ç –º–∏–Ω—É—Å–∞ - –¥–æ–±–∞–≤—å—Ç–µ!

## –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤–∞—à Telegram ID. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ @userinfobot –≤ Telegram –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /start. –û–Ω –≤–µ—Ä–Ω–µ—Ç –≤–∞—à ID.

–ó–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–∑–∞–º–µ–Ω–∏—Ç–µ YOUR_TELEGRAM_ID –Ω–∞ –≤–∞—à ID):
```
https://willow-coffee-order.onrender.com/api/test-notifications/direct/YOUR_TELEGRAM_ID
```

**–ü—Ä–∏–º–µ—Ä:**
```
https://willow-coffee-order.onrender.com/api/test-notifications/direct/123456789
```

**–î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞:**
```
üß™ Test Message

–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç Willow Bot.
–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ —ç—Ç–æ - –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

### –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ù–ï –ø—Ä–∏—à–ª–æ:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ –±–æ—Ç–∞**
   - –û—Ç–∫—Ä–æ–π—Ç–µ @Willow_coffee_bot
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ /start
   - –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ @userinfobot —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ID
   - ID —ç—Ç–æ —á–∏—Å–ª–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä: 123456789

## –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–∫–∞–∑–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ curl –∏–ª–∏ Postman –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ POST –∑–∞–ø—Ä–æ—Å–∞:

```bash
curl -X POST "https://willow-coffee-order.onrender.com/api/test-notifications/order" \
  -H "Content-Type: application/json" \
  -d '{"chatId": "YOUR_TELEGRAM_ID"}'
```

**–ó–∞–º–µ–Ω–∏—Ç–µ YOUR_TELEGRAM_ID –Ω–∞ –≤–∞—à Telegram ID!**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –≤ –≥—Ä—É–ø–ø—É –ø–µ—Ä—Å–æ–Ω–∞–ª–∞
- –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:
```
üßæ New order
üë§ @test_user
üì± Telegram ID: YOUR_ID
üí≥ Card: #1234
‚è±Ô∏è When: Now ‚Äî table 5
üí∞ Payment: cash
üì¶ Items:
‚Ä¢ Espresso √ó2 ‚Äî 300 RSD
‚Ä¢ Croissant √ó1 ‚Äî 200 RSD
‚Äî ‚Äî ‚Äî
üíµ Total: 500 RSD
‚≠ê –ù–∞—á–∏—Å–ª–µ–Ω–æ –∑–≤–µ–∑–¥: +1 (–≤—Å–µ–≥–æ —É –∫–ª–∏–µ–Ω—Ç–∞: 5)
```

## –®–∞–≥ 5: –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ Mini App

1. –û—Ç–∫—Ä–æ–π—Ç–µ @Willow_coffee_bot –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ "‚òï –ó–∞–∫–∞–∑–∞—Ç—å"
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É
4. –û—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑
5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
   - ‚úÖ –õ–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –∑–∞–∫–∞–∑–∞
   - ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É –ø–µ—Ä—Å–æ–Ω–∞–ª–∞

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: `hasGroupChatId: false`
**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Render Dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
3. Environment ‚Üí Add Environment Variable
4. Key: `GROUP_CHAT_ID`
5. Value: `-1002479746516`
6. Save Changes

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç, –Ω–æ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `ok: true`
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render (–≤–∫–ª–∞–¥–∫–∞ Logs)
2. –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å üì® –∏ ‚ùå
3. –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É –æ—Ç Telegram API - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "Forbidden: bot was blocked by the user"
**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ "Start" –∏–ª–∏ "Restart"
3. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ—Å—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: "Bad Request: chat not found"
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ GROUP_CHAT_ID –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ ID –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –º–∏–Ω—É—Å–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–∫–∞–∑–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```
[2025-12-10T...] POST /api/order
üõí Order request from user: 123456789
‚úÖ Order created: o_1733...
‚≠ê Added 1 stars to card 1234
üì§ Sending notifications...
üì§ User ID: 123456789
üì§ Order: { orderNumber: 'o_1733...', cardNumber: '1234', ... }
üì® sendHTMLMessage called: { chatId: 123456789, hasBotToken: true }
üì® Sending to Telegram API...
üì® Telegram API response: { ok: true, result: { ... } }
‚úÖ Message sent to 123456789
üì® sendHTMLMessage called: { chatId: '-1002479746516', hasBotToken: true }
üì® Sending to Telegram API...
üì® Telegram API response: { ok: true, result: { ... } }
‚úÖ Message sent to -1002479746516
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
