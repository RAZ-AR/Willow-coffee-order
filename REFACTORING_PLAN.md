# ğŸ—ï¸ Frontend Refactoring Plan - Phase 2

## ğŸ“Š Current State Analysis

**App.tsx: 1165 lines** - Ğ¼Ğ¾Ğ½Ğ¾Ğ»Ğ¸Ñ‚Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚:

### ğŸ§© ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ (ÑƒĞ¶Ğµ Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½Ñ‹):
1. `Header` (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 720-782) - ĞºĞ°Ñ€Ñ‚Ğ° + Ğ·Ğ²ĞµĞ·Ğ´Ñ‹ + ĞºĞ¾Ñ€Ğ·Ğ¸Ğ½Ğ°
2. `LangPicker` (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 783-803) - Ğ²Ñ‹Ğ±Ğ¾Ñ€ ÑĞ·Ñ‹ĞºĞ°  
3. `AdsCarousel` (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 805-885) - ĞºĞ°Ñ€ÑƒÑĞµĞ»ÑŒ Ğ±Ğ°Ğ½Ğ½ĞµÑ€Ğ¾Ğ²
4. `CartSheet` (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 887-1129) - ĞºĞ¾Ñ€Ğ·Ğ¸Ğ½Ğ° + Ğ·Ğ°ĞºĞ°Ğ·

### ğŸ”§ Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ (Ğ´Ğ»Ñ Ğ²Ñ‹Ğ½ĞµÑĞµĞ½Ğ¸Ñ):
- `toNumber`, `currency`, `titleByLang` (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 46-95)
- `mapMenu`, `mapAds` (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 105-142)
- `postJSON` (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 144-191)
- `cartAdd` (ÑÑ‚Ñ€Ğ¾ĞºĞ° 253)

### ğŸ£ Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ´Ğ»Ñ hooks:
- **Telegram detection** (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 208-242)
- **Cart management** (ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ ĞºĞ¾Ñ€Ğ·Ğ¸Ğ½Ñ‹)
- **API calls** (register, stars, order)
- **Menu/Ads loading**
- **Language management**

---

## ğŸ“ ĞĞ¾Ğ²Ğ°Ñ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Header/
â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”œâ”€â”€ LangPicker.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ Menu/
â”‚   â”‚   â”œâ”€â”€ MenuGrid.tsx
â”‚   â”‚   â”œâ”€â”€ CategoryFilter.tsx
â”‚   â”‚   â”œâ”€â”€ MenuItem.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ Cart/
â”‚   â”‚   â”œâ”€â”€ CartSheet.tsx
â”‚   â”‚   â”œâ”€â”€ CartItem.tsx
â”‚   â”‚   â”œâ”€â”€ OrderForm.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ Ads/
â”‚   â”‚   â”œâ”€â”€ AdsCarousel.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ Layout/
â”‚       â”œâ”€â”€ BottomBar.tsx
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useTelegramAuth.ts
â”‚   â”œâ”€â”€ useApi.ts
â”‚   â”œâ”€â”€ useCart.ts
â”‚   â”œâ”€â”€ useMenu.ts
â”‚   â””â”€â”€ useLoyalty.ts
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ formatters.ts
â”‚   â”œâ”€â”€ mappers.ts
â”‚   â””â”€â”€ telegram.ts
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ menu.ts
â”‚   â””â”€â”€ telegram.ts
â”œâ”€â”€ constants/
â”‚   â””â”€â”€ index.ts
â””â”€â”€ App.tsx (< 200 ÑÑ‚Ñ€Ğ¾Ğº)
```

---

## ğŸ¯ ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹ ĞŸĞ»Ğ°Ğ½

### Step 1: ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ğ¿ĞºĞ¸ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
- [ ] Ğ’Ñ‹Ğ½ĞµÑÑ‚Ğ¸ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ¸ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑ‹
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹

### Step 2: Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ Ğ¸ helpers
- [ ] Ğ’Ñ‹Ğ½ĞµÑÑ‚Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‚ĞµÑ€Ñ‹ (currency, toNumber)
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ API ĞºĞ»Ğ¸ĞµĞ½Ñ‚
- [ ] Ğ’Ñ‹Ğ½ĞµÑÑ‚Ğ¸ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Step 3: ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ Ñ…ÑƒĞºĞ¸
- [ ] useTelegramAuth (Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ñ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ñ‹)
- [ ] useApi (Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğº Ğ±ÑĞºĞµĞ½Ğ´Ñƒ)
- [ ] useCart (ĞºĞ¾Ñ€Ğ·Ğ¸Ğ½Ğ°)
- [ ] useMenu (Ğ¼ĞµĞ½Ñ + Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğ°)
- [ ] useLoyalty (ĞºĞ°Ñ€Ñ‚Ñ‹ + Ğ·Ğ²ĞµĞ·Ğ´Ñ‹)

### Step 4: ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
- [ ] Header + LangPicker
- [ ] Menu ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
- [ ] Cart ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹  
- [ ] Ads ĞºĞ°Ñ€ÑƒÑĞµĞ»ÑŒ
- [ ] Layout ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

### Step 5: Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ App.tsx
- [ ] Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ½Ğ¾Ğ²Ñ‹Ñ… ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²
- [ ] Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ…ÑƒĞºĞ¾Ğ²
- [ ] Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°

### Step 6: Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- [ ] ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
- [ ] ĞÑ‚Ğ»Ğ°Ğ´ĞºĞ° Ğ±Ğ°Ğ³Ğ¾Ğ²
- [ ] ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

---

## ğŸ¯ ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğ¹ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚

**Ğ˜Ğ·:** App.tsx (1165 ÑÑ‚Ñ€Ğ¾Ğº)
**Ğ’:** 
- App.tsx (~150 ÑÑ‚Ñ€Ğ¾Ğº)
- 15+ Ğ¿ĞµÑ€ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ñ… ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²
- 5 ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ñ… Ñ…ÑƒĞºĞ¾Ğ²
- Ğ§Ğ¸ÑÑ‚Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ñ Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸ĞµĞ¼ Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸

**Ğ’Ñ‹Ğ³Ğ¾Ğ´Ñ‹:**
âœ… Ğ›ĞµĞ³Ñ‡Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸  
âœ… ĞŸĞµÑ€ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹  
âœ… Ğ›ÑƒÑ‡ÑˆĞµĞµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ  
âœ… Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ğ°Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ°  
âœ… TypeScript Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

---

## âš ï¸ Ğ Ğ¸ÑĞºĞ¸ Ğ¸ Mitigation

**Ğ Ğ¸ÑĞº:** Ğ¡Ğ»Ğ¾Ğ¼Ğ°Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** ĞŸĞ¾ÑÑ‚ĞµĞ¿ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ€ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑˆĞ°Ğ³Ğ°

**Ğ Ğ¸ÑĞº:** ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ñ‹ Ğ² git
**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ§Ğ°ÑÑ‚Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚Ñ‹ Ñ Ğ¿Ğ¾Ğ½ÑÑ‚Ğ½Ñ‹Ğ¼Ğ¸ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸ÑĞ¼Ğ¸

**Ğ Ğ¸ÑĞº:** Ğ£Ñ…ÑƒĞ´ÑˆĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸  
**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ bundle size, React.memo Ğ³Ğ´Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾